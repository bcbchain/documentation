<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="robots" content="index,follow">
    <meta name="author" content="bcb-project">
    <meta name="application-name" content="bcbchain.io">
    <meta name="renderer" content="ie-stand">
    <title>First Smart Contract</title>
    <meta property="og:type" content="website" />
    <meta property="og:title" content="BCB Documentation" />
    <meta property="og:description" content="BCB Documentation" />
    <meta property="og:image" content="/img/twitter-img.jpg" />
    <meta name="twitter:title" content="BCB Documentation" />
    <meta name="twitter:description" content="BCB Documentation" />
    <meta name="twitter:image" content="/img/twitter-img.jpg" />
    <meta name="twitter:card" content="summary_large_image" />

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
    <link rel="manifest" href="/img/site.webmanifest">
    <link rel="mask-icon" href="/img/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#00aba9">
    <meta name="theme-color" content="#ffffff">

    <link href="/lib/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="/lib/animate.css/animate.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/styles/default.min.css">
    <link href="/lib/font-awesome/css/all.min.css" rel="stylesheet" />
    <link href="/css/site.min.css?v=20191106" rel="stylesheet" />
</head>
<body data-spy="scroll" data-target="#navbar-sidenav">
    <nav class="navbar fixed-top navbar-expand-lg py-1 px-3 px-sm-4 px-md-5">
        <a class="navbar-brand" href="https://bcbchain.io">
            <img class="logo" src="/img/logo.png" alt="BCB Logo" />
            <img class="logo-dark" src="/img/logo-dark.png" alt="BCB Logo" />
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <i class="fas fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="/docs/index.html">Documentation</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/tutorial/index.html">Tutorial</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/faq/index.html">FAQ</a>
                </li>
                <li class="nav-item" style="margin-right: 100px">
                    <a class="nav-link" href="/articles/index.html">Articles</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link d-inline-block" href="javascript:" onclick="languageEx('en-us')">EN</a>|<a class="nav-link d-inline-block" href="javascript:" onclick="languageEx('zh-cn')">中文</a>
                </li>
            </ul>
            <form class="form-inline my-2 my-lg-0 d-none">
                <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
            </form>
        </div>
    </nav>
    <div class="container-fluid" style="margin-top: 55px">
        <div class="row d-flex">
            <div class="d-none d-md-block catalog py-2 py-md-5 pl-md-3">
                <div class="search-bar">
                    <span class="search-de">X</span>
                    <input id="sInput" placeholder="search" />
                    <div class="search-re">
                        <ul id="sResult"></ul>
                    </div>
                </div>
                
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/Site Map.html'>Site Map</a>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>BCBBasic</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/01-BCBBasic/01-BCBIntro.html'>BCBIntro</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/01-BCBBasic/02-BCBNode.html'>BCBNode</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>BCBNetwork</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/02-BCBNetwork/01-MainnetAndTestnet.html'>MainnetAndTestnet</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/02-BCBNetwork/02-BuildForPrivateChain.html'>BuildForPrivateChain</a>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>BCBSideChain</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/02-BCBNetwork/BCBSideChain/01-SideChainRegistration.html'>SideChainRegistration</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/02-BCBNetwork/BCBSideChain/02-SideChainCreation.html'>SideChainCreation</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/02-BCBNetwork/BCBSideChain/03-SideChainGovernance.html'>SideChainGovernance</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/02-BCBNetwork/BCBSideChain/04-CrossChainTransaction.html'>CrossChainTransaction</a>
</nav>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>BCBTools</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/03-BCBTools/01-Overview.html'>Overview</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/03-BCBTools/02-bcw.html'>bcw</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/03-BCBTools/03-bcc.html'>bcc</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/03-BCBTools/04-smccheck.html'>smccheck</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/03-BCBTools/05-smcpack.html'>smcpack</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/03-BCBTools/06-sigorg.html'>sigorg</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/03-BCBTools/07-addr.html'>addr</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/03-BCBTools/08-orgid.html'>orgid</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/03-BCBTools/09-genesis.html'>genesis</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/03-BCBTools/10-txparse.html'>txparse</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>SmartContractDev</span>
<nav class='nav nav-pills flex-column ml-3'>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>SmartContract(golang)</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/04-SmartContractDev/SmartContract(golang)/01-Overview.html'>Overview</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/04-SmartContractDev/SmartContract(golang)/02-ProgrammingExample.html'>ProgrammingExample</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/04-SmartContractDev/SmartContract(golang)/03-DeeperUnderstanding.html'>DeeperUnderstanding</a>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>DevSmartContract</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/04-SmartContractDev/SmartContract(golang)/DevSmartContract/01-DevelopmentEnvironment.html'>DevelopmentEnvironment</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/04-SmartContractDev/SmartContract(golang)/DevSmartContract/02-FirstSmartContract.html'>FirstSmartContract</a>
</nav>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>SmartContract(solidity)</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/04-SmartContractDev/SmartContract(solidity)/01-BVM-EVM-diff.html'>BVM-EVM-diff</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/04-SmartContractDev/SmartContract(solidity)/02-Smart-Contract-Dev.html'>Smart-Contract-Dev</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/04-SmartContractDev/SmartContract(solidity)/03-Contract-deployment-call.html'>Contract-deployment-call</a>
</nav>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>ExchangeIntegrationGuide</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/05-ExchangeIntegrationGuide/01-IntroductionOfIntegrationScheme.html'>IntroductionOfIntegrationScheme</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/05-ExchangeIntegrationGuide/02-InstallationDeployment.html'>InstallationDeployment</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/05-ExchangeIntegrationGuide/03-CommandDetails.html'>CommandDetails</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>DevelopmentReference</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/01-Overview.html'>Overview</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/02-ModelDescription.html'>ModelDescription</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/03-AlgorithmDescription.html'>AlgorithmDescription</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/04-TransactionFormatv1.html'>TransactionFormatv1</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/05-TransactionFormatv2.html'>TransactionFormatv2</a>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>MainChainAPI</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/01-MainChainAPI/01-Protocol.html'>Protocol</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/01-MainChainAPI/02-NetworkInterface.html'>NetworkInterface</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/01-MainChainAPI/03-BlockchainInterface.html'>BlockchainInterface</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/01-MainChainAPI/04-TransactionInterface.html'>TransactionInterface</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/01-MainChainAPI/05-GlobalInterface.html'>GlobalInterface</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>SmartContractAPI</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/02-SmartContractAPI/01-Overview.html'>Overview</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/02-SmartContractAPI/02-Functions.html'>Functions</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/02-SmartContractAPI/03-sdk.types.html'>sdk.types</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/02-SmartContractAPI/04-sdk.bn.html'>sdk.bn</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/02-SmartContractAPI/05-sdk.crypto.ed25519.html'>sdk.crypto.ed25519</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/02-SmartContractAPI/06-sdk.crypto.sha3.html'>sdk.crypto.sha3</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/02-SmartContractAPI/07-Toolbox.html'>Toolbox</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/02-SmartContractAPI/08-Interfaces.html'>Interfaces</a>
</nav>
<span class='ml-0 my-1 nav-link'><i class='fas fa-caret-right'></i>ExchangeAPI</span>
<nav class='nav nav-pills flex-column ml-3'>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/03-ExchangeAPI/01-CommunicationProtocol.html'>CommunicationProtocol</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/03-ExchangeAPI/02-WalletInterface.html'>WalletInterface</a>
<a class='ml-0 my-1 nav-link' href='/docs/en-us/06-DevelopmentReference/03-ExchangeAPI/03-BlockchainInterface.html'>BlockchainInterface</a>
</nav>
</nav>
</nav>
            </div>
            <main class="p-3 p-sm-4 p-md-5">
                <a class="d-block d-md-none" href="javascript:" onclick="showCatalog()">Show / Hide Table of Contents</a>
                <h1 id='f08107d8'><span class='bd-content-title'>First Smart Contract<a class='anchorjs-link ' href='#f08107d8' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h1>
<h2 id='f1e90821'><span class='bd-content-title'>1. Create a new contract<a class='anchorjs-link ' href='#f1e90821' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'>Let&#39;s start by creating the first smart contract.</p>
<p class='with-space'>Using <code>GoLand</code>  open the  <code>GoLand Project</code> you just created and create a new smart contract with the BCBChain plugin. The following is the execution path:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='GoLand left sidebar Project Explorer
    &gt;&gt; Right click on the src/contract directory to bring up the menu
        &gt;&gt; BCB Smart Contract
            &gt;&gt; New...
                &gt;&gt; Input  Name         #demo1
                &gt;&gt; Input  Type         #Demo1
                &gt;&gt; Input  Version       #1.0
                &gt;&gt; Input  Organization #orgE37w7wxhZwaox1fhndt5Czm8WnLBrh6db - DAO
                &gt;&gt; Input  Author       #alice
                &gt;&gt; OK'>Copy</button><pre><code class='text' lang='text'>GoLand left sidebar Project Explorer
    &gt;&gt; Right click on the src/contract directory to bring up the menu
        &gt;&gt; BCB Smart Contract
            &gt;&gt; New...
                &gt;&gt; Input  Name         #demo1
                &gt;&gt; Input  Type         #Demo1
                &gt;&gt; Input  Version       #1.0
                &gt;&gt; Input  Organization #orgE37w7wxhZwaox1fhndt5Czm8WnLBrh6db - DAO
                &gt;&gt; Input  Author       #alice
                &gt;&gt; OK
</code></pre>
</figure>
<p class='with-space'>Successful creation of the smart contract will automatically generate the framework code. The file path is as follows:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='src/contract/mydonation/v1.0/mydonation/mydonation.go'>Copy</button><pre><code class='text' lang='text'>src/contract/mydonation/v1.0/mydonation/mydonation.go
</code></pre>
</figure>
<p class='with-space'>The initial code for the smart contract is as follows:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='package mydonation

import (
    &quot;blockchain/smcsdk/sdk&quot;
)

//Mydonation This is struct of contract
//@:contract:mydonation
//@:version:1.0
//@:organization:orgE37w7wxhZwaox1fhndt5Czm8WnLBrh6db
//@:author:e5b95784049c3b8669aa58ba08abd9f54281df8905dd3af24bf795b0103f9ec7
type Mydonation struct {
    sdk sdk.ISmartContract

    //This is a sample field which is to store in db
    //@:public:store
    sampleStore string
}

//InitChain Constructor of this Mydonation
//@:constructor
func (m *Mydonation) InitChain() {
    //TODO
    //This method is automatically selected when the block height reaches
    //the contract effective block height.
}

//UpdateChain Constructor of this Mydonation
//@:constructor
func (m *Mydonation) UpdateChain() {
    //TODO
    //This method is automatically selected when the block height reaches
    //the new version contract effective block height.
}

//SampleMethod This is a sample method
//@:public:method:gas[500]
func (m *Mydonation) SampleMethod() {

}'>Copy</button><pre><code class='go' lang='go'>package mydonation

import (
    &quot;blockchain/smcsdk/sdk&quot;
)

//Mydonation This is struct of contract
//@:contract:mydonation
//@:version:1.0
//@:organization:orgE37w7wxhZwaox1fhndt5Czm8WnLBrh6db
//@:author:e5b95784049c3b8669aa58ba08abd9f54281df8905dd3af24bf795b0103f9ec7
type Mydonation struct {
    sdk sdk.ISmartContract

    //This is a sample field which is to store in db
    //@:public:store
    sampleStore string
}

//InitChain Constructor of this Mydonation
//@:constructor
func (m *Mydonation) InitChain() {
    //TODO
    //This method is automatically selected when the block height reaches
    //the contract effective block height.
}

//UpdateChain Constructor of this Mydonation
//@:constructor
func (m *Mydonation) UpdateChain() {
    //TODO
    //This method is automatically selected when the block height reaches
    //the new version contract effective block height.
}

//SampleMethod This is a sample method
//@:public:method:gas[500]
func (m *Mydonation) SampleMethod() {

}
</code></pre>
</figure>
<h2 id='cb95d55e'><span class='bd-content-title'>2. Donation Contract<a class='anchorjs-link ' href='#cb95d55e' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'>Let&#39;s modify the smart contract to make it more interesting. The following smart contract code contains a set of simple functions for charitable donations. The modified code is as follows:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='package mydonation

import (
    &quot;blockchain/smcsdk/sdk&quot;
    &quot;blockchain/smcsdk/sdk/bn&quot;
    &quot;blockchain/smcsdk/sdk/forx&quot;
    &quot;blockchain/smcsdk/sdk/std&quot;
    &quot;blockchain/smcsdk/sdk/types&quot;
)

//Mydonation This is struct of contract
//@:contract:mydonation
//@:version:1.0
//@:organization:orgE37w7wxhZwaox1fhndt5Czm8WnLBrh6db
//@:author:e5b95784049c3b8669aa58ba08abd9f54281df8905dd3af24bf795b0103f9ec7
type Mydonation struct {
    sdk sdk.ISmartContract

    //Total donations received by donees
    //@:public:store
    donations map[types.Address]bn.Number // key=address of donee
}

const (
    errDoneeCannotBeOwner = 55000 + iota,
    errDoneeCannotBeSmc,
    errDoneeAlreadyExist,
    errDoneeNotExist,
    errDonationExist,
    errDonationNotEnough
)

//@:public:receipt
type receipt interface {
    emitAddDonee(donee types.Address)
    emitDelDonee(donee types.Address)
    emitDonate(from, donee types.Address, value, balance bn.Number)
    emitTransferDonation(donee types.Address, value, balance bn.Number)
}

//InitChain Constructor of this Mydonation
//@:constructor
func (m *Mydonation) InitChain() {
    //TODO
    //This method is automatically selected when the block height reaches
    //the contract effective block height.
}

//UpdateChain Constructor of this Mydonation
//@:constructor
func (m *Mydonation) UpdateChain() {
    //TODO
    //This method is automatically selected when the block height reaches
    //the new version contract effective block height.
}

//AddDonee Add a new donee
//@:public:method:gas[500]
func (d *Mydonation) AddDonee(donee types.Address) {
    sdk.RequireOwner()
    sdk.RequireAddress(donee)
    sdk.Require(donee != d.sdk.Message().Sender().Address(),
        errDoneeCannotBeOwner, &quot;Donee can not be owner&quot;)
    sdk.Require(donee != d.sdk.Message().Contract().Address(),
        errDoneeCannotBeSmc, &quot;Donee can not be this smart contract&quot;)
    sdk.Require(donee != d.sdk.Message().Contract().Account().Address(),
        errDoneeCannotBeSmc, &quot;Donee can not be account of this smart contract&quot;)
    sdk.Require(!d._chkDonations(donee),
        errDoneeAlreadyExist, &quot;Donee already exists&quot;)

    d._setDonations(donee, bn.N(0))

    //emit receipt
    d.emitAddDonee(donee)
}

//Donate delete a donee
//@:public:method:gas[500]
func (d *Mydonation) DelDonee(donee types.Address) {
    sdk.RequireOwner()
    sdk.RequireAddress(donee)
    sdk.Require(d._chkDonations(donee),
        errDoneeNotExist, &quot;Donee does not exist&quot;)
    sdk.Require(d._donations(donee).IsEqualI(0),
        errDonationExist, &quot;Donation exists&quot;)

    d._delDonations(donee)

    //emit receipt
    d.emitDelDonee(donee)
}

//Donate Charitable donors donate money to smart contract
//@:public:method:gas[500]
func (d *Mydonation) Donate(donee types.Address) {
    sdk.RequireAddress(donee)
    sdk.Require(d._chkDonations(donee),
        errDoneeNotExist, &quot;Donee does not exist&quot;)

    var valTome *std.Transfer
    token := d.sdk.Helper().GenesisHelper().Token()
    forx.Range(d.sdk.Message().GetTransferToMe(), func(i int, receipt *std.Transfer) {
        sdk.Require(receipt.Token == token.Address(),
            types.ErrInvalidParameter, &quot;Accept donations in genesis token only&quot;)
        sdk.Require(valTome == nil,
            types.ErrInvalidParameter, &quot;Accept only one donation at a time&quot;)
        valTome = receipt
    })
    sdk.Require(valTome != nil,
        types.ErrInvalidParameter, &quot;Please transfer token to me first&quot;)

    balance := d._donations(donee).Add(valTome.Value)
    d._setDonations(donee, balance)

    //emit receipt
    d.emitDonate(
        d.sdk.Message().Sender().Address(),
        donee,
        valTome.Value,
        balance,
    )
}

//Withdraw To transfer donations to donee
//@:public:method:gas[500]
func (d *Mydonation) Transfer(donee types.Address, value bn.Number) {
    sdk.RequireOwner()
    sdk.RequireAddress(donee)
    sdk.Require(d._chkDonations(donee),
        errDoneeNotExist, &quot;Donee does not exist&quot;)
    sdk.Require(value.IsGreaterThanI(0),
        types.ErrInvalidParameter, &quot;Parameter \&quot;value\&quot; must be greater than 0&quot;)
    sdk.Require(d._donations(donee).IsGE(value),
        errDonationNotEnough, &quot;Donation is not enough&quot;)

    token := d.sdk.Helper().GenesisHelper().Token()
    account := d.sdk.Message().Contract().Account()
    account.TransferByToken(token.Address(), donee, value)
    balance := d._donations(donee).Sub(value)
    d._setDonations(donee, balance)

    //emit receipt
    d.emitTransferDonation(
        donee,
        value,
        balance,
    )
}'>Copy</button><pre><code class='go' lang='go'>package mydonation

import (
    &quot;blockchain/smcsdk/sdk&quot;
    &quot;blockchain/smcsdk/sdk/bn&quot;
    &quot;blockchain/smcsdk/sdk/forx&quot;
    &quot;blockchain/smcsdk/sdk/std&quot;
    &quot;blockchain/smcsdk/sdk/types&quot;
)

//Mydonation This is struct of contract
//@:contract:mydonation
//@:version:1.0
//@:organization:orgE37w7wxhZwaox1fhndt5Czm8WnLBrh6db
//@:author:e5b95784049c3b8669aa58ba08abd9f54281df8905dd3af24bf795b0103f9ec7
type Mydonation struct {
    sdk sdk.ISmartContract

    //Total donations received by donees
    //@:public:store
    donations map[types.Address]bn.Number // key=address of donee
}

const (
    errDoneeCannotBeOwner = 55000 + iota,
    errDoneeCannotBeSmc,
    errDoneeAlreadyExist,
    errDoneeNotExist,
    errDonationExist,
    errDonationNotEnough
)

//@:public:receipt
type receipt interface {
    emitAddDonee(donee types.Address)
    emitDelDonee(donee types.Address)
    emitDonate(from, donee types.Address, value, balance bn.Number)
    emitTransferDonation(donee types.Address, value, balance bn.Number)
}

//InitChain Constructor of this Mydonation
//@:constructor
func (m *Mydonation) InitChain() {
    //TODO
    //This method is automatically selected when the block height reaches
    //the contract effective block height.
}

//UpdateChain Constructor of this Mydonation
//@:constructor
func (m *Mydonation) UpdateChain() {
    //TODO
    //This method is automatically selected when the block height reaches
    //the new version contract effective block height.
}

//AddDonee Add a new donee
//@:public:method:gas[500]
func (d *Mydonation) AddDonee(donee types.Address) {
    sdk.RequireOwner()
    sdk.RequireAddress(donee)
    sdk.Require(donee != d.sdk.Message().Sender().Address(),
        errDoneeCannotBeOwner, &quot;Donee can not be owner&quot;)
    sdk.Require(donee != d.sdk.Message().Contract().Address(),
        errDoneeCannotBeSmc, &quot;Donee can not be this smart contract&quot;)
    sdk.Require(donee != d.sdk.Message().Contract().Account().Address(),
        errDoneeCannotBeSmc, &quot;Donee can not be account of this smart contract&quot;)
    sdk.Require(!d._chkDonations(donee),
        errDoneeAlreadyExist, &quot;Donee already exists&quot;)

    d._setDonations(donee, bn.N(0))

    //emit receipt
    d.emitAddDonee(donee)
}

//Donate delete a donee
//@:public:method:gas[500]
func (d *Mydonation) DelDonee(donee types.Address) {
    sdk.RequireOwner()
    sdk.RequireAddress(donee)
    sdk.Require(d._chkDonations(donee),
        errDoneeNotExist, &quot;Donee does not exist&quot;)
    sdk.Require(d._donations(donee).IsEqualI(0),
        errDonationExist, &quot;Donation exists&quot;)

    d._delDonations(donee)

    //emit receipt
    d.emitDelDonee(donee)
}

//Donate Charitable donors donate money to smart contract
//@:public:method:gas[500]
func (d *Mydonation) Donate(donee types.Address) {
    sdk.RequireAddress(donee)
    sdk.Require(d._chkDonations(donee),
        errDoneeNotExist, &quot;Donee does not exist&quot;)

    var valTome *std.Transfer
    token := d.sdk.Helper().GenesisHelper().Token()
    forx.Range(d.sdk.Message().GetTransferToMe(), func(i int, receipt *std.Transfer) {
        sdk.Require(receipt.Token == token.Address(),
            types.ErrInvalidParameter, &quot;Accept donations in genesis token only&quot;)
        sdk.Require(valTome == nil,
            types.ErrInvalidParameter, &quot;Accept only one donation at a time&quot;)
        valTome = receipt
    })
    sdk.Require(valTome != nil,
        types.ErrInvalidParameter, &quot;Please transfer token to me first&quot;)

    balance := d._donations(donee).Add(valTome.Value)
    d._setDonations(donee, balance)

    //emit receipt
    d.emitDonate(
        d.sdk.Message().Sender().Address(),
        donee,
        valTome.Value,
        balance,
    )
}

//Withdraw To transfer donations to donee
//@:public:method:gas[500]
func (d *Mydonation) Transfer(donee types.Address, value bn.Number) {
    sdk.RequireOwner()
    sdk.RequireAddress(donee)
    sdk.Require(d._chkDonations(donee),
        errDoneeNotExist, &quot;Donee does not exist&quot;)
    sdk.Require(value.IsGreaterThanI(0),
        types.ErrInvalidParameter, &quot;Parameter \&quot;value\&quot; must be greater than 0&quot;)
    sdk.Require(d._donations(donee).IsGE(value),
        errDonationNotEnough, &quot;Donation is not enough&quot;)

    token := d.sdk.Helper().GenesisHelper().Token()
    account := d.sdk.Message().Contract().Account()
    account.TransferByToken(token.Address(), donee, value)
    balance := d._donations(donee).Sub(value)
    d._setDonations(donee, balance)

    //emit receipt
    d.emitTransferDonation(
        donee,
        value,
        balance,
    )
}
</code></pre>
</figure>
<p class='with-space'>Let&#39;s briefly describe the methods provided by this contract.</p>
<h3 id='dbcf3a98'><span class='bd-content-title'>2.1 AddDonee<a class='anchorjs-link ' href='#dbcf3a98' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h3>
<p class='with-space'>The <code>AddDonee</code> method adds an account address for accepting donations to the smart contract.</p>
<p class='with-space'>Constraint is as follows:</p>
<blockquote class='bd-callout with-space'>
<ul class='with-space'>
<li>
<p class='with-space'>Only the contract owner can call;</p></li>
<li>
<p class='with-space'>The input parameter <code>donee</code> must be a legal address;</p></li>
<li>
<p class='with-space'>The input parameter <code>donee</code> cannot be the contract owner;</p></li>
<li>
<p class='with-space'>The input parameter <code>donee</code> cannot be the contract address;</p></li>
<li>
<p class='with-space'>The input parameter <code>donee</code> cannot be the contract account address;</p></li>
<li>
<p class='with-space'>The input parameter <code>donee</code> cannot be an existing account address for receiving donations.</p></li>
</ul>
</blockquote>
<p class='with-space'>Execution results:</p>
<blockquote class='bd-callout with-space'>
<ul class='with-space'>
<li>
<p class='with-space'>State Database:</p>
<p class='with-space'>Creates a new KEY: <code>/orgBtjfCSPCAJ84uQWcpNr74NLMWYm5SXzer/mydonation/xxx</code>  ,where  <code>xxx</code>  is the address corresponding to the input parameter  <code>donee</code>  ,Value：  <code>0</code>；</p></li>
<li>
<p class='with-space'>BCBChain：</p>
<p class='with-space'>Results of successful transaction execution can be scanned, which includes receipts <code>addDonee</code>:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='type addDonee struct { 
   Donee types.Address `json:&quot;donee&quot;` 
} '>Copy</button><pre><code class='go' lang='go'>type addDonee struct { 
   Donee types.Address `json:&quot;donee&quot;` 
} 
</code></pre>
</figure></li>
</ul>
</blockquote>
<h3 id='dd257bd0'><span class='bd-content-title'>2.2 DelDonee<a class='anchorjs-link ' href='#dd257bd0' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h3>
<p class='with-space'>The <code>DelDonee</code> method deletes an account address that receives donations from the smart contract.</p>
<p class='with-space'>Constraint is as follows:</p>
<blockquote class='bd-callout with-space'>
<ul class='with-space'>
<li>
<p class='with-space'>Only the contract owner can call;</p></li>
<li>
<p class='with-space'>The input parameter <code>donee</code> must be a legal address;</p></li>
<li>
<p class='with-space'>The input parameter <code>donee</code> must be an existing account address for receiving donations;</p></li>
<li>
<p class='with-space'>The input parameter <code>donee</code>&#39;s all donations received have been withdrawn or no donations have been received.</p></li>
</ul>
</blockquote>
<p class='with-space'>Results of execution:</p>
<blockquote class='bd-callout with-space'>
<ul class='with-space'>
<li>
<p class='with-space'>State Database:</p>
<p class='with-space'>Deletes the KEY: <code>/orgBtjfCSPCAJ84uQWcpNr74NLMWYm5SXzer/mydonation/xxx</code>  ,where  <code>xxx</code>  is the address corresponding to the input parameter  <code>donee</code>；</p></li>
<li>
<p class='with-space'>BCBChain：</p>
<p class='with-space'>Results of successful transaction execution can be scanned, which includes receipts:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='type delDonee struct { 
  Donee types.Address `json:&quot;donee&quot;` 
} '>Copy</button><pre><code class='go' lang='go'>type delDonee struct { 
  Donee types.Address `json:&quot;donee&quot;` 
} 
</code></pre>
</figure></li>
</ul>
</blockquote>
<h3 id='a6913f3a'><span class='bd-content-title'>2.3 Donate<a class='anchorjs-link ' href='#a6913f3a' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h3>
<p class='with-space'>The <code>Donate</code> method makes a donation to an account address in the smart contract that accepts donations.</p>
<p class='with-space'>Constraint is as follows:</p>
<blockquote class='bd-callout with-space'>
<ul class='with-space'>
<li>
<p class='with-space'>Anyone can call;</p></li>
<li>
<p class='with-space'>The input parameter <code>donee</code> must be a legal address;</p></li>
<li>
<p class='with-space'>The input parameter <code>donee</code> must be an existing account address for receiving donations;</p></li>
<li>
<p class='with-space'>The call to the <code>Donate</code>  method must be preceded by a transfer message that passes the transfer receipt to the  <code>Donate</code> method;</p></li>
<li>
<p class='with-space'>The destination address of the received transfer receipt must be the account address of <code>mydonation</code> contract；</p></li>
<li>
<p class='with-space'>The donation received must be the <code>BCB</code> token on BCBChain；</p></li>
<li>
<p class='with-space'>Only one donation (transfer receipt) meeting the above conditions can be received.</p></li>
</ul>
</blockquote>
<p class='with-space'>Results of execution:</p>
<blockquote class='bd-callout with-space'>
<ul class='with-space'>
<li>
<p class='with-space'>State Database:</p>
<p class='with-space'>Updates the KEY: <code>/orgBtjfCSPCAJ84uQWcpNr74NLMWYm5SXzer/mydonation/xxx</code>  ,where  <code>xxx</code>  is the address corresponding to the input parameter  <code>donee</code> , Value: increase the value corresponding to the transfer amount;</p></li>
<li>
<p class='with-space'>BCBChain：</p>
<p class='with-space'>Results of successful transaction execution can be scanned, which includes receipts:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='type donate struct { 
  From    types.Address `json:&quot;from&quot;` 
  Donee   types.Address `json:&quot;donee&quot;` 
  Value   bn.Number     `json:&quot;value&quot;` 
  Balance bn.Number     `json:&quot;balance&quot;` 
} '>Copy</button><pre><code class='go' lang='go'>type donate struct { 
  From    types.Address `json:&quot;from&quot;` 
  Donee   types.Address `json:&quot;donee&quot;` 
  Value   bn.Number     `json:&quot;value&quot;` 
  Balance bn.Number     `json:&quot;balance&quot;` 
} 
</code></pre>
</figure></li>
</ul>
</blockquote>
<h3 id='d36ba1d7'><span class='bd-content-title'>2.4 Transfer<a class='anchorjs-link ' href='#d36ba1d7' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h3>
<p class='with-space'>The <code>Transfer</code> method transfers the donation received from the smart contract to the account address receiving the donation.</p>
<p class='with-space'>Constraint is as follows:</p>
<blockquote class='bd-callout with-space'>
<ul class='with-space'>
<li>
<p class='with-space'>Only the contract owner can call;</p></li>
<li>
<p class='with-space'>The input parameter <code>donee</code> must be a legal address;</p></li>
<li>
<p class='with-space'>The input parameter <code>donee</code> must be an existing account address for receiving donations;</p></li>
<li>
<p class='with-space'>The input parameter <code>value</code>  must be greater than or equal to  <code>0</code>;</p></li>
<li>
<p class='with-space'>The accepted donation balance at the address corresponding to the input parameter <code>donee</code>  must be greater than or equal to the input parameter  <code>value</code>.</p></li>
</ul>
</blockquote>
<p class='with-space'>Results of execution:</p>
<blockquote class='bd-callout with-space'>
<ul class='with-space'>
<li>
<p class='with-space'>State Database:</p>
<p class='with-space'>Updates the KEY: <code>/orgBtjfCSPCAJ84uQWcpNr74NLMWYm5SXzer/mydonation/xxx</code>  ,where  <code>xxx</code>  is the address corresponding to the input parameter  <code>donee</code>  , Value: subtract the value corresponding to the input parameter  <code>value</code>;</p>
<p class='with-space'>Updates the KEY: <code>/account/ex/xxx/token/yyy</code>  , where  <code>xxx</code>  is the address corresponding to the input parameter donee,  <code>yyy</code>  is the BCB token address on  <code>BCBChain</code>  , Value: add the value corresponding to the input parameter  <code>value</code> to the account balance.</p></li>
<li>
<p class='with-space'>BCBChain：</p>
<p class='with-space'>Results of successful transaction execution can be scanned, which includes receipts:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='type transferDonation struct { 
  Donee   types.Address `json:&quot;donee&quot;` 
  Value   bn.Number     `json:&quot;value&quot;` 
  Balance bn.Number     `json:&quot;balance&quot;` 
}

type std.Transfer struct { 
  Token types.Address `json:&quot;token&quot;` // Token types.Address 
  From  types.Address `json:&quot;from&quot;`  // Account address of Sender 
  To    types.Address `json:&quot;to&quot;`    // Account address of Receiver 
  Value bn.Number     `json:&quot;value&quot;` // Transfer value 
} '>Copy</button><pre><code class='go' lang='go'>type transferDonation struct { 
  Donee   types.Address `json:&quot;donee&quot;` 
  Value   bn.Number     `json:&quot;value&quot;` 
  Balance bn.Number     `json:&quot;balance&quot;` 
}

type std.Transfer struct { 
  Token types.Address `json:&quot;token&quot;` // Token types.Address 
  From  types.Address `json:&quot;from&quot;`  // Account address of Sender 
  To    types.Address `json:&quot;to&quot;`    // Account address of Receiver 
  Value bn.Number     `json:&quot;value&quot;` // Transfer value 
} 
</code></pre>
</figure></li>
</ul>
</blockquote>
<h2 id='a48fa780'><span class='bd-content-title'>3. Contract specification check<a class='anchorjs-link ' href='#a48fa780' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'>The following execution path can check whether the charitable donation contract completed above conforms to the BCBChain smart contract specification:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='GoLand left sidebar Project Explorer
    &gt;&gt; Right click on the src/contract/mydonation/v1.0/mydonation directory to bring up
       the menu
            &gt;&gt; BCB Smart Contract
                &gt;&gt; Check'>Copy</button><pre><code class='text' lang='text'>GoLand left sidebar Project Explorer
    &gt;&gt; Right click on the src/contract/mydonation/v1.0/mydonation directory to bring up
       the menu
            &gt;&gt; BCB Smart Contract
                &gt;&gt; Check
</code></pre>
</figure>
<h2 id='db6cebc6'><span class='bd-content-title'>4. Contract code completion<a class='anchorjs-link ' href='#db6cebc6' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'>So far, we have completed the contract code which will be uploaded to the <code>BCBChain</code>  , but this contract code cannot be directly run in  <code>Goland IDE</code>, and can only be run locally after completing the code using the code generation function provided by the plugin, the following is the execution path of the completion code:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='GoLand left sidebar Project Explorer
    &gt;&gt; Right click on the src/contract/mydonation/v1.0/mydonation directory to bring up
       the menu
            &gt;&gt; BCB Smart Contract
                &gt;&gt; Generate Code'>Copy</button><pre><code class='text' lang='text'>GoLand left sidebar Project Explorer
    &gt;&gt; Right click on the src/contract/mydonation/v1.0/mydonation directory to bring up
       the menu
            &gt;&gt; BCB Smart Contract
                &gt;&gt; Generate Code
</code></pre>
</figure>
<p class='with-space'>After the completion code is executed, the following code files will be automatically generated in the contract code directory:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='//The following files will overwrite the original contents every time the code is
//automatically generated. Please do not modify these code files.
mydonation_autogen_store.go            //Auto-completed code for state database accessing
mydonation_autogen_receipt.go        //Auto-completed code for receipts
mydonation_autogen_sdk.go            //Auto-completed code for miscellaneous
mydonation_wrap_test.go                //Auto-completed code for unit test

//The following files are codes for unit testing, which require programmers to complete
//the unit tests for each method. The contents of these files will not be automatically
//modified the next time the code is automatically generated.
mydonation_case_adddonee_test.go    //Auto-completed unit test code -  for AddDonee
mydonation_case_deldonee_test.go    //Auto-completed unit test code -  for DelDonee
mydonation_case_donate_test.go        //Auto-completed unit test code -  for Donate
mydonation_case_transfer_test.go    //Auto-completed unit test code -  for Transfer'>Copy</button><pre><code class='text' lang='text'>//The following files will overwrite the original contents every time the code is
//automatically generated. Please do not modify these code files.
mydonation_autogen_store.go            //Auto-completed code for state database accessing
mydonation_autogen_receipt.go        //Auto-completed code for receipts
mydonation_autogen_sdk.go            //Auto-completed code for miscellaneous
mydonation_wrap_test.go                //Auto-completed code for unit test

//The following files are codes for unit testing, which require programmers to complete
//the unit tests for each method. The contents of these files will not be automatically
//modified the next time the code is automatically generated.
mydonation_case_adddonee_test.go    //Auto-completed unit test code -  for AddDonee
mydonation_case_deldonee_test.go    //Auto-completed unit test code -  for DelDonee
mydonation_case_donate_test.go        //Auto-completed unit test code -  for Donate
mydonation_case_transfer_test.go    //Auto-completed unit test code -  for Transfer
</code></pre>
</figure>
<p class='with-space'>The following is the content of <code>mydonation_autogen_store.go</code>:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='package mydonation

import (
    &quot;fmt&quot;
    &quot;blockchain/smcsdk/sdk/types&quot;
    &quot;blockchain/smcsdk/sdk/bn&quot;
)

//_setDonations This is a method of Mydonation
func (m *Mydonation) _setDonations(k types.Address, v bn.Number) {
    m.sdk.Helper().StateHelper().Set(fmt.Sprintf(&quot;/donations/%v&quot;, k), &amp;v)
}

//_donations This is a method of Mydonation
func (m *Mydonation) _donations(k types.Address) bn.Number {
    temp := bn.N(0)
    return *m.sdk.Helper().StateHelper().GetEx(fmt.Sprintf(&quot;/donations/%v&quot;, k), &amp;temp).(*bn.Number)
}

//_chkDonations This is a method of Mydonation
func (m *Mydonation) _chkDonations(k types.Address) bool {
    return m.sdk.Helper().StateHelper().Check(fmt.Sprintf(&quot;/donations/%v&quot;, k))
}

//_delDonations This is a method of Mydonation
func (m *Mydonation) _delDonations(k types.Address) {
    m.sdk.Helper().StateHelper().Delete(fmt.Sprintf(&quot;/donations/%v&quot;, k))
}'>Copy</button><pre><code class='go' lang='go'>package mydonation

import (
    &quot;fmt&quot;
    &quot;blockchain/smcsdk/sdk/types&quot;
    &quot;blockchain/smcsdk/sdk/bn&quot;
)

//_setDonations This is a method of Mydonation
func (m *Mydonation) _setDonations(k types.Address, v bn.Number) {
    m.sdk.Helper().StateHelper().Set(fmt.Sprintf(&quot;/donations/%v&quot;, k), &amp;v)
}

//_donations This is a method of Mydonation
func (m *Mydonation) _donations(k types.Address) bn.Number {
    temp := bn.N(0)
    return *m.sdk.Helper().StateHelper().GetEx(fmt.Sprintf(&quot;/donations/%v&quot;, k), &amp;temp).(*bn.Number)
}

//_chkDonations This is a method of Mydonation
func (m *Mydonation) _chkDonations(k types.Address) bool {
    return m.sdk.Helper().StateHelper().Check(fmt.Sprintf(&quot;/donations/%v&quot;, k))
}

//_delDonations This is a method of Mydonation
func (m *Mydonation) _delDonations(k types.Address) {
    m.sdk.Helper().StateHelper().Delete(fmt.Sprintf(&quot;/donations/%v&quot;, k))
}
</code></pre>
</figure>
<p class='with-space'>The following is the content of <code>mydonation_autogen_receipt.go</code>:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='package mydonation

import (
    &quot;blockchain/smcsdk/sdk/types&quot;
    &quot;blockchain/smcsdk/sdk/bn&quot;
)

var _ receipt = (*Mydonation)(nil)

//emitAddDonee This is a method of Mydonation
func (m *Mydonation) emitAddDonee(donee types.Address) {
    type addDonee struct {
        Donee types.Address `json:&quot;donee&quot;`
    }

    m.sdk.Helper().ReceiptHelper().Emit(
        addDonee{
            Donee: donee,
        },
    )
}

//emitDelDonee This is a method of Mydonation
func (m *Mydonation) emitDelDonee(donee types.Address) {
    type delDonee struct {
        Donee types.Address `json:&quot;donee&quot;`
    }

    m.sdk.Helper().ReceiptHelper().Emit(
        delDonee{
            Donee: donee,
        },
    )
}

//emitDonate This is a method of Mydonation
func (m *Mydonation) emitDonate(from, donee types.Address, value, balance bn.Number) {
    type donate struct {
        From    types.Address `json:&quot;from&quot;`
        Donee   types.Address `json:&quot;donee&quot;`
        Value   bn.Number     `json:&quot;value&quot;`
        Balance bn.Number     `json:&quot;balance&quot;`
    }

    m.sdk.Helper().ReceiptHelper().Emit(
        donate{
            From:    from,
            Donee:   donee,
            Value:   value,
            Balance: balance,
        },
    )
}

//emitTransferDonation This is a method of Mydonation
func (m *Mydonation) emitTransferDonation(donee types.Address, value, balance bn.Number) {
    type transferDonation struct {
        Donee   types.Address `json:&quot;donee&quot;`
        Value   bn.Number     `json:&quot;value&quot;`
        Balance bn.Number     `json:&quot;balance&quot;`
    }

    m.sdk.Helper().ReceiptHelper().Emit(
        transferDonation{
            Donee:   donee,
            Value:   value,
            Balance: balance,
        },
    )
}'>Copy</button><pre><code class='go' lang='go'>package mydonation

import (
    &quot;blockchain/smcsdk/sdk/types&quot;
    &quot;blockchain/smcsdk/sdk/bn&quot;
)

var _ receipt = (*Mydonation)(nil)

//emitAddDonee This is a method of Mydonation
func (m *Mydonation) emitAddDonee(donee types.Address) {
    type addDonee struct {
        Donee types.Address `json:&quot;donee&quot;`
    }

    m.sdk.Helper().ReceiptHelper().Emit(
        addDonee{
            Donee: donee,
        },
    )
}

//emitDelDonee This is a method of Mydonation
func (m *Mydonation) emitDelDonee(donee types.Address) {
    type delDonee struct {
        Donee types.Address `json:&quot;donee&quot;`
    }

    m.sdk.Helper().ReceiptHelper().Emit(
        delDonee{
            Donee: donee,
        },
    )
}

//emitDonate This is a method of Mydonation
func (m *Mydonation) emitDonate(from, donee types.Address, value, balance bn.Number) {
    type donate struct {
        From    types.Address `json:&quot;from&quot;`
        Donee   types.Address `json:&quot;donee&quot;`
        Value   bn.Number     `json:&quot;value&quot;`
        Balance bn.Number     `json:&quot;balance&quot;`
    }

    m.sdk.Helper().ReceiptHelper().Emit(
        donate{
            From:    from,
            Donee:   donee,
            Value:   value,
            Balance: balance,
        },
    )
}

//emitTransferDonation This is a method of Mydonation
func (m *Mydonation) emitTransferDonation(donee types.Address, value, balance bn.Number) {
    type transferDonation struct {
        Donee   types.Address `json:&quot;donee&quot;`
        Value   bn.Number     `json:&quot;value&quot;`
        Balance bn.Number     `json:&quot;balance&quot;`
    }

    m.sdk.Helper().ReceiptHelper().Emit(
        transferDonation{
            Donee:   donee,
            Value:   value,
            Balance: balance,
        },
    )
}
</code></pre>
</figure>
<p class='with-space'>The following is the initial content of unit test code, take <code>mydonation_case_adddonee_test.go</code> file as an example:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='package mydonation

import (
    &quot;blockchain/smcsdk/sdk&quot;
)

func (mysuit *MySuite) test_Donate(owner sdk.IAccount, test *TestObject) {
    //TODO
}'>Copy</button><pre><code class='go' lang='go'>package mydonation

import (
    &quot;blockchain/smcsdk/sdk&quot;
)

func (mysuit *MySuite) test_Donate(owner sdk.IAccount, test *TestObject) {
    //TODO
}
</code></pre>
</figure>
<h2 id='dc6e7680'><span class='bd-content-title'>5. Contract unit test<a class='anchorjs-link ' href='#dc6e7680' aria-label='Anchor' data-anchorjs-icon='#'></a></span></h2>
<p class='with-space'>Let&#39;s complete the unit test code of the charitable donation contract.</p>
<p class='with-space'>Source code： <code>mydonation_case_AddDonee_test.go</code>:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='package mydonation

import (
    &quot;blockchain/smcsdk/common/gls&quot;
    &quot;blockchain/smcsdk/sdk&quot;
    &quot;blockchain/smcsdk/sdk/bn&quot;
    &quot;blockchain/smcsdk/sdk/types&quot;
    &quot;blockchain/smcsdk/utest&quot;
    &quot;fmt&quot;

    &quot;gopkg.in/check.v1&quot;
)

func keyOfDonation(addr types.Address) string {
    return fmt.Sprintf(&quot;/donations/%v&quot;, addr)
}

//AddDonee This is a method of MySuite
func (mysuit *MySuite) TestDemo_AddDonee(c *check.C) {
    utest.Init(orgID)
    contractOwner := utest.DeployContract(c, contractName, orgID, contractMethods, contractInterfaces)

    gls.Mgr.SetValues(gls.Values{gls.SDKKey: utest.UTP.ISmartContract}, func() {
        test := NewTestObject(contractOwner)
        test.setSender(contractOwner).InitChain()
        mysuit.test_AddDonee(contractOwner, test)
    })
}

func (mysuit *MySuite) test_AddDonee(owner sdk.IAccount, test *TestObject) {
    fmt.Println(&quot;=== Run  UnitTest case: AddDonee(donee types.Address)&quot;)

    fmt.Println(&quot;=== prepare for test&quot;)
    zero := bn.N(0)
    oneCoin := bn.N(1000000000)
    a1 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    a2 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for authorization&quot;)
    test.run(types.ErrNoAuthorization, func(t *TestObject) types.Error {
        return t.setSender(a1).AddDonee(a2.Address())
    })
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for parameters&quot;)
    //prepare
    var cases = []struct {
        sender     sdk.IAccount
        addr       types.Address
        codeExpect uint32
    }{
        {owner, &quot;&quot;, types.ErrInvalidAddress},
        {owner, &quot;local&quot;, types.ErrInvalidAddress},
        {owner, &quot;localhshskhjkshfsswtsysyst6t76ddsg7s7w&quot;, types.ErrInvalidAddress},
        {owner, owner.Address(), errDoneeCannotBeOwner},
        {owner, utest.GetContract().Address(), errDoneeCannotBeSmc},
        {owner, utest.GetContract().Account().Address(), errDoneeCannotBeSmc},
    }
    //run
    for _, c := range cases {
        test.run(c.codeExpect, func(t *TestObject) types.Error {
            return t.setSender(c.sender).AddDonee(c.addr)
        })
    }
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for business logic&quot;)
    //prepare
    utest.AssertSDB(keyOfDonation(a1.Address()), nil)
    //run
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        return t.setSender(owner).AddDonee(a1.Address())
    })
    test.run(errDoneeAlreadyExist, func(t *TestObject) types.Error {
        return t.setSender(owner).AddDonee(a1.Address())
    })
    //check
    utest.AssertSDB(keyOfDonation(a1.Address()), &amp;zero)
    utest.AssertSDB(keyOfDonation(a2.Address()), nil)
    fmt.Println(&quot;=== pass&quot;)
}'>Copy</button><pre><code class='go' lang='go'>package mydonation

import (
    &quot;blockchain/smcsdk/common/gls&quot;
    &quot;blockchain/smcsdk/sdk&quot;
    &quot;blockchain/smcsdk/sdk/bn&quot;
    &quot;blockchain/smcsdk/sdk/types&quot;
    &quot;blockchain/smcsdk/utest&quot;
    &quot;fmt&quot;

    &quot;gopkg.in/check.v1&quot;
)

func keyOfDonation(addr types.Address) string {
    return fmt.Sprintf(&quot;/donations/%v&quot;, addr)
}

//AddDonee This is a method of MySuite
func (mysuit *MySuite) TestDemo_AddDonee(c *check.C) {
    utest.Init(orgID)
    contractOwner := utest.DeployContract(c, contractName, orgID, contractMethods, contractInterfaces)

    gls.Mgr.SetValues(gls.Values{gls.SDKKey: utest.UTP.ISmartContract}, func() {
        test := NewTestObject(contractOwner)
        test.setSender(contractOwner).InitChain()
        mysuit.test_AddDonee(contractOwner, test)
    })
}

func (mysuit *MySuite) test_AddDonee(owner sdk.IAccount, test *TestObject) {
    fmt.Println(&quot;=== Run  UnitTest case: AddDonee(donee types.Address)&quot;)

    fmt.Println(&quot;=== prepare for test&quot;)
    zero := bn.N(0)
    oneCoin := bn.N(1000000000)
    a1 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    a2 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for authorization&quot;)
    test.run(types.ErrNoAuthorization, func(t *TestObject) types.Error {
        return t.setSender(a1).AddDonee(a2.Address())
    })
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for parameters&quot;)
    //prepare
    var cases = []struct {
        sender     sdk.IAccount
        addr       types.Address
        codeExpect uint32
    }{
        {owner, &quot;&quot;, types.ErrInvalidAddress},
        {owner, &quot;local&quot;, types.ErrInvalidAddress},
        {owner, &quot;localhshskhjkshfsswtsysyst6t76ddsg7s7w&quot;, types.ErrInvalidAddress},
        {owner, owner.Address(), errDoneeCannotBeOwner},
        {owner, utest.GetContract().Address(), errDoneeCannotBeSmc},
        {owner, utest.GetContract().Account().Address(), errDoneeCannotBeSmc},
    }
    //run
    for _, c := range cases {
        test.run(c.codeExpect, func(t *TestObject) types.Error {
            return t.setSender(c.sender).AddDonee(c.addr)
        })
    }
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for business logic&quot;)
    //prepare
    utest.AssertSDB(keyOfDonation(a1.Address()), nil)
    //run
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        return t.setSender(owner).AddDonee(a1.Address())
    })
    test.run(errDoneeAlreadyExist, func(t *TestObject) types.Error {
        return t.setSender(owner).AddDonee(a1.Address())
    })
    //check
    utest.AssertSDB(keyOfDonation(a1.Address()), &amp;zero)
    utest.AssertSDB(keyOfDonation(a2.Address()), nil)
    fmt.Println(&quot;=== pass&quot;)
}
</code></pre>
</figure>
<p class='with-space'>Source code： <code>mydonation_case_DelDonee_test.go</code></p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='package mydonation

import (
    &quot;blockchain/smcsdk/common/gls&quot;
    &quot;blockchain/smcsdk/sdk&quot;
    &quot;blockchain/smcsdk/sdk/bn&quot;
    &quot;blockchain/smcsdk/sdk/types&quot;
    &quot;blockchain/smcsdk/utest&quot;
    &quot;fmt&quot;

    &quot;gopkg.in/check.v1&quot;
)

//DelDonee This is a method of MySuite
func (mysuit *MySuite) TestDemo_DelDonee(c *check.C) {
    utest.Init(orgID)
    contractOwner := utest.DeployContract(c, contractName, orgID, contractMethods, contractInterfaces)

    gls.Mgr.SetValues(gls.Values{gls.SDKKey: utest.UTP.ISmartContract}, func() {
        test := NewTestObject(contractOwner)
        test.setSender(contractOwner).InitChain()
        mysuit.test_DelDonee(contractOwner, test)
    })
}

func (mysuit *MySuite) test_DelDonee(owner sdk.IAccount, test *TestObject) {
    fmt.Println(&quot;=== Run  UnitTest case: DelDonee(donee types.Address)&quot;)

    fmt.Println(&quot;=== prepare for test&quot;)
    zero := bn.N(0)
    oneCoin := bn.N(1000000000)
    halfCoin := bn.N(500000000)
    a1 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    a2 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    a3 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        return t.setSender(owner).AddDonee(a1.Address())
    })
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        return t.setSender(owner).AddDonee(a2.Address())
    })
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        t.setSender(a1)
        utest.Assert(t.transfer(halfCoin) != nil)
        return t.Donate(a2.Address())
    })
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for authorization&quot;)
    test.run(types.ErrNoAuthorization, func(t *TestObject) types.Error {
        return t.setSender(a2).DelDonee(a1.Address())
    })
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for parameters&quot;)
    //prepare
    var cases = []struct {
        sender     sdk.IAccount
        addr       types.Address
        codeExpect uint32
    }{
        {owner, &quot;&quot;, types.ErrInvalidAddress},
        {owner, &quot;local&quot;, types.ErrInvalidAddress},
        {owner, &quot;localhshskhjkshfsswtsysyst6t76ddsg7s7w&quot;, types.ErrInvalidAddress},
        {owner, owner.Address(), errDoneeNotExist},
        {owner, utest.GetContract().Address(), errDoneeNotExist},
        {owner, utest.GetContract().Account().Address(), errDoneeNotExist},
        {owner, a3.Address(), errDoneeNotExist},
    }
    //run
    for _, c := range cases {
        test.run(c.codeExpect, func(t *TestObject) types.Error {
            return t.setSender(c.sender).DelDonee(c.addr)
        })
    }
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for business logic 1&quot;)
    //prepare
    utest.AssertSDB(keyOfDonation(a1.Address()), &amp;zero)
    //run
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        return t.setSender(owner).DelDonee(a1.Address())
    })
    //check
    utest.AssertSDB(keyOfDonation(a1.Address()), nil)
    //run
    test.run(errDoneeNotExist, func(t *TestObject) types.Error {
        t.setSender(owner)
        return t.DelDonee(a1.Address())
    })
    //check
    utest.AssertSDB(keyOfDonation(a1.Address()), nil)
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for business logic 2&quot;)
    //prepare
    utest.AssertSDB(keyOfDonation(a2.Address()), &amp;halfCoin)
    //run
    test.run(errDonationExist, func(t *TestObject) types.Error {
        return t.setSender(owner).DelDonee(a2.Address())
    })
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        t.setSender(owner)
        return t.Transfer(a2.Address(), halfCoin)
    })

    utest.AssertSDB(keyOfDonation(a2.Address()), &amp;zero)
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        t.setSender(owner)
        return t.DelDonee(a2.Address())
    })
    //check
    utest.AssertSDB(keyOfDonation(a2.Address()), nil)
    //run
    test.run(errDoneeNotExist, func(t *TestObject) types.Error {
        t.setSender(owner)
        return t.DelDonee(a2.Address())
    })
    //check
    utest.AssertBalance(a2, &quot;TSC&quot;, oneCoin.Add(halfCoin))
    fmt.Println(&quot;=== pass&quot;)
}'>Copy</button><pre><code class='go' lang='go'>package mydonation

import (
    &quot;blockchain/smcsdk/common/gls&quot;
    &quot;blockchain/smcsdk/sdk&quot;
    &quot;blockchain/smcsdk/sdk/bn&quot;
    &quot;blockchain/smcsdk/sdk/types&quot;
    &quot;blockchain/smcsdk/utest&quot;
    &quot;fmt&quot;

    &quot;gopkg.in/check.v1&quot;
)

//DelDonee This is a method of MySuite
func (mysuit *MySuite) TestDemo_DelDonee(c *check.C) {
    utest.Init(orgID)
    contractOwner := utest.DeployContract(c, contractName, orgID, contractMethods, contractInterfaces)

    gls.Mgr.SetValues(gls.Values{gls.SDKKey: utest.UTP.ISmartContract}, func() {
        test := NewTestObject(contractOwner)
        test.setSender(contractOwner).InitChain()
        mysuit.test_DelDonee(contractOwner, test)
    })
}

func (mysuit *MySuite) test_DelDonee(owner sdk.IAccount, test *TestObject) {
    fmt.Println(&quot;=== Run  UnitTest case: DelDonee(donee types.Address)&quot;)

    fmt.Println(&quot;=== prepare for test&quot;)
    zero := bn.N(0)
    oneCoin := bn.N(1000000000)
    halfCoin := bn.N(500000000)
    a1 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    a2 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    a3 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        return t.setSender(owner).AddDonee(a1.Address())
    })
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        return t.setSender(owner).AddDonee(a2.Address())
    })
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        t.setSender(a1)
        utest.Assert(t.transfer(halfCoin) != nil)
        return t.Donate(a2.Address())
    })
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for authorization&quot;)
    test.run(types.ErrNoAuthorization, func(t *TestObject) types.Error {
        return t.setSender(a2).DelDonee(a1.Address())
    })
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for parameters&quot;)
    //prepare
    var cases = []struct {
        sender     sdk.IAccount
        addr       types.Address
        codeExpect uint32
    }{
        {owner, &quot;&quot;, types.ErrInvalidAddress},
        {owner, &quot;local&quot;, types.ErrInvalidAddress},
        {owner, &quot;localhshskhjkshfsswtsysyst6t76ddsg7s7w&quot;, types.ErrInvalidAddress},
        {owner, owner.Address(), errDoneeNotExist},
        {owner, utest.GetContract().Address(), errDoneeNotExist},
        {owner, utest.GetContract().Account().Address(), errDoneeNotExist},
        {owner, a3.Address(), errDoneeNotExist},
    }
    //run
    for _, c := range cases {
        test.run(c.codeExpect, func(t *TestObject) types.Error {
            return t.setSender(c.sender).DelDonee(c.addr)
        })
    }
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for business logic 1&quot;)
    //prepare
    utest.AssertSDB(keyOfDonation(a1.Address()), &amp;zero)
    //run
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        return t.setSender(owner).DelDonee(a1.Address())
    })
    //check
    utest.AssertSDB(keyOfDonation(a1.Address()), nil)
    //run
    test.run(errDoneeNotExist, func(t *TestObject) types.Error {
        t.setSender(owner)
        return t.DelDonee(a1.Address())
    })
    //check
    utest.AssertSDB(keyOfDonation(a1.Address()), nil)
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for business logic 2&quot;)
    //prepare
    utest.AssertSDB(keyOfDonation(a2.Address()), &amp;halfCoin)
    //run
    test.run(errDonationExist, func(t *TestObject) types.Error {
        return t.setSender(owner).DelDonee(a2.Address())
    })
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        t.setSender(owner)
        return t.Transfer(a2.Address(), halfCoin)
    })

    utest.AssertSDB(keyOfDonation(a2.Address()), &amp;zero)
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        t.setSender(owner)
        return t.DelDonee(a2.Address())
    })
    //check
    utest.AssertSDB(keyOfDonation(a2.Address()), nil)
    //run
    test.run(errDoneeNotExist, func(t *TestObject) types.Error {
        t.setSender(owner)
        return t.DelDonee(a2.Address())
    })
    //check
    utest.AssertBalance(a2, &quot;TSC&quot;, oneCoin.Add(halfCoin))
    fmt.Println(&quot;=== pass&quot;)
}
</code></pre>
</figure>
<p class='with-space'>Source code： <code>mydonation_case_Donate_test.go</code></p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='package mydonation

import (
    &quot;blockchain/smcsdk/common/gls&quot;
    &quot;blockchain/smcsdk/sdk&quot;
    &quot;blockchain/smcsdk/sdk/bn&quot;
    &quot;blockchain/smcsdk/sdk/types&quot;
    &quot;blockchain/smcsdk/utest&quot;
    &quot;fmt&quot;

    &quot;gopkg.in/check.v1&quot;
)

//Donate This is a method of MySuite
func (mysuit *MySuite) TestDemo_Donate(c *check.C) {
    utest.Init(orgID)
    contractOwner := utest.DeployContract(c, contractName, orgID, contractMethods, contractInterfaces)

    gls.Mgr.SetValues(gls.Values{gls.SDKKey: utest.UTP.ISmartContract}, func() {
        test := NewTestObject(contractOwner)
        test.setSender(contractOwner).InitChain()
        mysuit.test_Donate(contractOwner, test)
    })
}

func (mysuit *MySuite) test_Donate(owner sdk.IAccount, test *TestObject) {
    fmt.Println(&quot;=== Run  UnitTest case: Donate(donee types.Address)&quot;)

    fmt.Println(&quot;=== prepare for test&quot;)
    halfCoin := bn.N(500000000)
    oneCoin := bn.N(1000000000)
    oneHalfCoin := bn.N(1500000000)
    twoCoin := bn.N(2000000000)
    utest.Transfer(nil, owner.Address(), &quot;TSC&quot;, twoCoin)
    utest.Transfer(nil, owner.Address(), &quot;BTC&quot;, twoCoin)
    a1 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    a2 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    a3 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        return t.setSender(owner).AddDonee(a1.Address())
    })
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for parameters&quot;)
    //prepare
    var cases = []struct {
        sender     sdk.IAccount
        addr       types.Address
        codeExpect uint32
    }{
        {owner, &quot;&quot;, types.ErrInvalidAddress},
        {owner, &quot;local&quot;, types.ErrInvalidAddress},
        {owner, &quot;localhshskhjkshfsswtsysyst6t76ddsg7s7w&quot;, types.ErrInvalidAddress},
        {owner, a2.Address(), errDoneeNotExist},
        {owner, a3.Address(), errDoneeNotExist},
    }
    //run
    for _, c := range cases {
        test.run(c.codeExpect, func(t *TestObject) types.Error {
            return t.setSender(c.sender).Donate(c.addr)
        })
    }
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for receipt of transfer&quot;)
    //run
    test.run(types.ErrInvalidParameter, func(t *TestObject) types.Error {
        return t.setSender(owner).Donate(a1.Address())
    })
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        t.setSender(owner)
        utest.Assert(t.transfer(&quot;TSC&quot;, halfCoin) != nil)
        return t.Donate(a1.Address())
    })
    test.run(types.ErrInvalidParameter, func(t *TestObject) types.Error {
        t.setSender(owner)
        utest.Assert(test.transfer(&quot;TSC&quot;, halfCoin) != nil)
        utest.Assert(test.transfer(&quot;TSC&quot;, halfCoin) != nil)
        return t.Donate(a1.Address())
    })
    test.run(types.ErrInvalidParameter, func(t *TestObject) types.Error {
        t.setSender(owner)
        utest.Assert(t.transfer(&quot;BTC&quot;, halfCoin) != nil)
        return t.Donate(a1.Address())
    })
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for business logic&quot;)
    //prepare
    utest.AssertSDB(keyOfDonation(a1.Address()), &amp;halfCoin)
    //run
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        t.setSender(a2)
        utest.Assert(t.transfer(halfCoin) != nil)
        return t.Donate(a1.Address())
    })
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        t.setSender(a3)
        utest.Assert(t.transfer(halfCoin) != nil)
        return t.Donate(a1.Address())
    })
    //check
    utest.AssertSDB(keyOfDonation(a1.Address()), &amp;oneHalfCoin)
    fmt.Println(&quot;=== pass&quot;)
}'>Copy</button><pre><code class='go' lang='go'>package mydonation

import (
    &quot;blockchain/smcsdk/common/gls&quot;
    &quot;blockchain/smcsdk/sdk&quot;
    &quot;blockchain/smcsdk/sdk/bn&quot;
    &quot;blockchain/smcsdk/sdk/types&quot;
    &quot;blockchain/smcsdk/utest&quot;
    &quot;fmt&quot;

    &quot;gopkg.in/check.v1&quot;
)

//Donate This is a method of MySuite
func (mysuit *MySuite) TestDemo_Donate(c *check.C) {
    utest.Init(orgID)
    contractOwner := utest.DeployContract(c, contractName, orgID, contractMethods, contractInterfaces)

    gls.Mgr.SetValues(gls.Values{gls.SDKKey: utest.UTP.ISmartContract}, func() {
        test := NewTestObject(contractOwner)
        test.setSender(contractOwner).InitChain()
        mysuit.test_Donate(contractOwner, test)
    })
}

func (mysuit *MySuite) test_Donate(owner sdk.IAccount, test *TestObject) {
    fmt.Println(&quot;=== Run  UnitTest case: Donate(donee types.Address)&quot;)

    fmt.Println(&quot;=== prepare for test&quot;)
    halfCoin := bn.N(500000000)
    oneCoin := bn.N(1000000000)
    oneHalfCoin := bn.N(1500000000)
    twoCoin := bn.N(2000000000)
    utest.Transfer(nil, owner.Address(), &quot;TSC&quot;, twoCoin)
    utest.Transfer(nil, owner.Address(), &quot;BTC&quot;, twoCoin)
    a1 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    a2 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    a3 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        return t.setSender(owner).AddDonee(a1.Address())
    })
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for parameters&quot;)
    //prepare
    var cases = []struct {
        sender     sdk.IAccount
        addr       types.Address
        codeExpect uint32
    }{
        {owner, &quot;&quot;, types.ErrInvalidAddress},
        {owner, &quot;local&quot;, types.ErrInvalidAddress},
        {owner, &quot;localhshskhjkshfsswtsysyst6t76ddsg7s7w&quot;, types.ErrInvalidAddress},
        {owner, a2.Address(), errDoneeNotExist},
        {owner, a3.Address(), errDoneeNotExist},
    }
    //run
    for _, c := range cases {
        test.run(c.codeExpect, func(t *TestObject) types.Error {
            return t.setSender(c.sender).Donate(c.addr)
        })
    }
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for receipt of transfer&quot;)
    //run
    test.run(types.ErrInvalidParameter, func(t *TestObject) types.Error {
        return t.setSender(owner).Donate(a1.Address())
    })
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        t.setSender(owner)
        utest.Assert(t.transfer(&quot;TSC&quot;, halfCoin) != nil)
        return t.Donate(a1.Address())
    })
    test.run(types.ErrInvalidParameter, func(t *TestObject) types.Error {
        t.setSender(owner)
        utest.Assert(test.transfer(&quot;TSC&quot;, halfCoin) != nil)
        utest.Assert(test.transfer(&quot;TSC&quot;, halfCoin) != nil)
        return t.Donate(a1.Address())
    })
    test.run(types.ErrInvalidParameter, func(t *TestObject) types.Error {
        t.setSender(owner)
        utest.Assert(t.transfer(&quot;BTC&quot;, halfCoin) != nil)
        return t.Donate(a1.Address())
    })
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for business logic&quot;)
    //prepare
    utest.AssertSDB(keyOfDonation(a1.Address()), &amp;halfCoin)
    //run
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        t.setSender(a2)
        utest.Assert(t.transfer(halfCoin) != nil)
        return t.Donate(a1.Address())
    })
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        t.setSender(a3)
        utest.Assert(t.transfer(halfCoin) != nil)
        return t.Donate(a1.Address())
    })
    //check
    utest.AssertSDB(keyOfDonation(a1.Address()), &amp;oneHalfCoin)
    fmt.Println(&quot;=== pass&quot;)
}
</code></pre>
</figure>
<p class='with-space'>Source code： <code>mydonation_case_Transfer_test.go</code></p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='package mydonation

import (
    &quot;blockchain/smcsdk/common/gls&quot;
    &quot;blockchain/smcsdk/sdk&quot;
    &quot;blockchain/smcsdk/sdk/bn&quot;
    &quot;blockchain/smcsdk/sdk/types&quot;
    &quot;blockchain/smcsdk/utest&quot;
    &quot;fmt&quot;

    &quot;gopkg.in/check.v1&quot;
)

//Transfer This is a method of MySuite
func (mysuit *MySuite) TestDemo_Transfer(c *check.C) {
    utest.Init(orgID)
    contractOwner := utest.DeployContract(c, contractName, orgID, contractMethods, contractInterfaces)

    gls.Mgr.SetValues(gls.Values{gls.SDKKey: utest.UTP.ISmartContract}, func() {
        test := NewTestObject(contractOwner)
        test.setSender(contractOwner).InitChain()
        mysuit.test_Transfer(contractOwner, test)
    })
}

func (mysuit *MySuite) test_Transfer(owner sdk.IAccount, test *TestObject) {
    fmt.Println(&quot;=== Run  UnitTest case: Transfer(donee types.Address, value bn.Number)&quot;)

    fmt.Println(&quot;=== prepare for test&quot;)
    zero := bn.N(0)
    oneCoin := bn.N(1000000000)
    halfCoin := bn.N(500000000)
    utest.Transfer(nil, owner.Address(), bn.N(2).Mul(oneCoin))
    a1 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    a2 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    a3 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        return t.setSender(owner).AddDonee(a1.Address())
    })
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        t.setSender(owner)
        utest.Assert(test.transfer(oneCoin) != nil)
        return t.Donate(a1.Address())
    })
    utest.AssertOK(test.AddDonee(a2.Address()))
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for authorization&quot;)
    //run
    test.run(types.ErrNoAuthorization, func(t *TestObject) types.Error {
        t.setSender(a2)
        utest.Assert(test.transfer(oneCoin) != nil)
        return t.Transfer(a1.Address(), halfCoin)
    })
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for parameters&quot;)
    //prepare
    var cases = []struct {
        sender     sdk.IAccount
        addr       types.Address
        amount     bn.Number
        codeExpect uint32
    }{
        {owner, &quot;&quot;, halfCoin, types.ErrInvalidAddress},
        {owner, &quot;local&quot;, halfCoin, types.ErrInvalidAddress},
        {owner, &quot;localhshskhjkshfsswtsysyst6t76ddsg7s7w&quot;, halfCoin, types.ErrInvalidAddress},
        {owner, owner.Address(), halfCoin, errDoneeNotExist},
        {owner, utest.GetContract().Address(), halfCoin, errDoneeNotExist},
        {owner, utest.GetContract().Account().Address(), halfCoin, errDoneeNotExist},
        {owner, a3.Address(), halfCoin, errDoneeNotExist},
        {owner, a1.Address(), bn.N(-1), types.ErrInvalidParameter},
        {owner, a1.Address(), bn.N(0), types.ErrInvalidParameter},
        {owner, a1.Address(), bn.N(1), types.CodeOK},
        {owner, a1.Address(), oneCoin, errDonationNotEnough},
    }
    //run
    for _, c := range cases {
        test.run(c.codeExpect, func(t *TestObject) types.Error {
            return t.setSender(c.sender).Transfer(c.addr, c.amount)
        })
    }
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for business logic&quot;)
    //prepare
    x := oneCoin.SubI(1)
    utest.AssertSDB(keyOfDonation(a1.Address()), &amp;x)
    //run
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        t.setSender(owner)
        utest.Assert(test.transfer(bn.N(1)) != nil)
        return t.Donate(a1.Address())
    })
    //check
    utest.AssertSDB(keyOfDonation(a1.Address()), &amp;oneCoin)
    //run
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        return t.setSender(owner).Transfer(a1.Address(), halfCoin)
    })
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        return t.setSender(owner).Transfer(a1.Address(), halfCoin)
    })
    //check
    utest.AssertSDB(keyOfDonation(a1.Address()), &amp;zero)
    utest.AssertBalance(a1, &quot;TSC&quot;, bn.N(2).Mul(oneCoin).AddI(1))
    fmt.Println(&quot;=== pass&quot;)
}'>Copy</button><pre><code class='go' lang='go'>package mydonation

import (
    &quot;blockchain/smcsdk/common/gls&quot;
    &quot;blockchain/smcsdk/sdk&quot;
    &quot;blockchain/smcsdk/sdk/bn&quot;
    &quot;blockchain/smcsdk/sdk/types&quot;
    &quot;blockchain/smcsdk/utest&quot;
    &quot;fmt&quot;

    &quot;gopkg.in/check.v1&quot;
)

//Transfer This is a method of MySuite
func (mysuit *MySuite) TestDemo_Transfer(c *check.C) {
    utest.Init(orgID)
    contractOwner := utest.DeployContract(c, contractName, orgID, contractMethods, contractInterfaces)

    gls.Mgr.SetValues(gls.Values{gls.SDKKey: utest.UTP.ISmartContract}, func() {
        test := NewTestObject(contractOwner)
        test.setSender(contractOwner).InitChain()
        mysuit.test_Transfer(contractOwner, test)
    })
}

func (mysuit *MySuite) test_Transfer(owner sdk.IAccount, test *TestObject) {
    fmt.Println(&quot;=== Run  UnitTest case: Transfer(donee types.Address, value bn.Number)&quot;)

    fmt.Println(&quot;=== prepare for test&quot;)
    zero := bn.N(0)
    oneCoin := bn.N(1000000000)
    halfCoin := bn.N(500000000)
    utest.Transfer(nil, owner.Address(), bn.N(2).Mul(oneCoin))
    a1 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    a2 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    a3 := utest.NewAccount(&quot;TSC&quot;, oneCoin)
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        return t.setSender(owner).AddDonee(a1.Address())
    })
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        t.setSender(owner)
        utest.Assert(test.transfer(oneCoin) != nil)
        return t.Donate(a1.Address())
    })
    utest.AssertOK(test.AddDonee(a2.Address()))
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for authorization&quot;)
    //run
    test.run(types.ErrNoAuthorization, func(t *TestObject) types.Error {
        t.setSender(a2)
        utest.Assert(test.transfer(oneCoin) != nil)
        return t.Transfer(a1.Address(), halfCoin)
    })
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for parameters&quot;)
    //prepare
    var cases = []struct {
        sender     sdk.IAccount
        addr       types.Address
        amount     bn.Number
        codeExpect uint32
    }{
        {owner, &quot;&quot;, halfCoin, types.ErrInvalidAddress},
        {owner, &quot;local&quot;, halfCoin, types.ErrInvalidAddress},
        {owner, &quot;localhshskhjkshfsswtsysyst6t76ddsg7s7w&quot;, halfCoin, types.ErrInvalidAddress},
        {owner, owner.Address(), halfCoin, errDoneeNotExist},
        {owner, utest.GetContract().Address(), halfCoin, errDoneeNotExist},
        {owner, utest.GetContract().Account().Address(), halfCoin, errDoneeNotExist},
        {owner, a3.Address(), halfCoin, errDoneeNotExist},
        {owner, a1.Address(), bn.N(-1), types.ErrInvalidParameter},
        {owner, a1.Address(), bn.N(0), types.ErrInvalidParameter},
        {owner, a1.Address(), bn.N(1), types.CodeOK},
        {owner, a1.Address(), oneCoin, errDonationNotEnough},
    }
    //run
    for _, c := range cases {
        test.run(c.codeExpect, func(t *TestObject) types.Error {
            return t.setSender(c.sender).Transfer(c.addr, c.amount)
        })
    }
    fmt.Println(&quot;=== pass&quot;)

    fmt.Println(&quot;=== test for business logic&quot;)
    //prepare
    x := oneCoin.SubI(1)
    utest.AssertSDB(keyOfDonation(a1.Address()), &amp;x)
    //run
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        t.setSender(owner)
        utest.Assert(test.transfer(bn.N(1)) != nil)
        return t.Donate(a1.Address())
    })
    //check
    utest.AssertSDB(keyOfDonation(a1.Address()), &amp;oneCoin)
    //run
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        return t.setSender(owner).Transfer(a1.Address(), halfCoin)
    })
    test.run(types.CodeOK, func(t *TestObject) types.Error {
        return t.setSender(owner).Transfer(a1.Address(), halfCoin)
    })
    //check
    utest.AssertSDB(keyOfDonation(a1.Address()), &amp;zero)
    utest.AssertBalance(a1, &quot;TSC&quot;, bn.N(2).Mul(oneCoin).AddI(1))
    fmt.Println(&quot;=== pass&quot;)
}
</code></pre>
</figure>
<p class='with-space'>After the unit test code is completed, you can use the following execution path to perform unit tests:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='GoLand left sidebar Project Explorer
    &gt;&gt; Right click on the src/contract/mydonation/v1.0/mydonation directory to bring up
       the menu
            &gt;&gt; Run
                &gt;&gt; go test mydonation'>Copy</button><pre><code class='text' lang='text'>GoLand left sidebar Project Explorer
    &gt;&gt; Right click on the src/contract/mydonation/v1.0/mydonation directory to bring up
       the menu
            &gt;&gt; Run
                &gt;&gt; go test mydonation
</code></pre>
</figure>
<p class='with-space'>After the unit test is completed, the test results are output as follows:</p>
<figure class='highlight'>
<button type='button' class='btn-clipboard' data-original-title='Copy to clipboard' data-clipboard-action='copy' data-toggle='tooltip' data-placement='top' title='Copy to clipboard' data-clipboard-text='GOROOT=C:\Go #gosetup
=== RUN   Test
=== Run  UnitTest case: AddDonee(donee types.Address)
=== prepare for test
=== pass
=== test for authorization
only contract owner just can do it
=== pass
=== test for parameters
Address chainID is error!
Address chainID is error!
Address chainID is error!
Donee can not be owner
Donee can not be this smart contract
Donee can not be account of this smart contract
=== pass
=== test for business logic
Donee already exists
=== pass
=== Run  UnitTest case: DelDonee(donee types.Address)
=== prepare for test
=== pass
=== test for authorization
only contract owner just can do it
=== pass
=== test for parameters
Address chainID is error!
Address chainID is error!
Address chainID is error!
Donee does not exist
Donee does not exist
Donee does not exist
Donee does not exist
=== pass
=== test for business logic 1
Donee does not exist
=== pass
=== test for business logic 2
Donation exists
Donee does not exist
=== pass
=== Run  UnitTest case: Donate(donee types.Address)
=== prepare for test
=== pass
=== test for parameters
Address chainID is error!
Address chainID is error!
Address chainID is error!
Donee does not exist
Donee does not exist
=== pass
=== test for receipt of transfer
Please transfer token to me first
Accept only one donation at a time
Accept donations in genesis token only
=== pass
=== test for business logic
=== pass
=== Run  UnitTest case: Transfer(donee types.Address, value bn.Number)
=== prepare for test
=== pass
=== test for authorization
only contract owner just can do it
=== pass
=== test for parameters
Address chainID is error!
Address chainID is error!
Address chainID is error!
Donee does not exist
Donee does not exist
Donee does not exist
Donee does not exist
Parameter &quot;value&quot; must be greater than 0
Parameter &quot;value&quot; must be greater than 0
Donation is not enough
=== pass
=== test for business logic
=== pass
OK: 4 passed
--- PASS: Test (0.14s)
PASS
ok      contract/orgexample/code/mydonation/v1.0/mydonation    (cached)

Process finished with exit code 0'>Copy</button><pre><code class='shell' lang='shell'>GOROOT=C:\Go #gosetup
=== RUN   Test
=== Run  UnitTest case: AddDonee(donee types.Address)
=== prepare for test
=== pass
=== test for authorization
only contract owner just can do it
=== pass
=== test for parameters
Address chainID is error!
Address chainID is error!
Address chainID is error!
Donee can not be owner
Donee can not be this smart contract
Donee can not be account of this smart contract
=== pass
=== test for business logic
Donee already exists
=== pass
=== Run  UnitTest case: DelDonee(donee types.Address)
=== prepare for test
=== pass
=== test for authorization
only contract owner just can do it
=== pass
=== test for parameters
Address chainID is error!
Address chainID is error!
Address chainID is error!
Donee does not exist
Donee does not exist
Donee does not exist
Donee does not exist
=== pass
=== test for business logic 1
Donee does not exist
=== pass
=== test for business logic 2
Donation exists
Donee does not exist
=== pass
=== Run  UnitTest case: Donate(donee types.Address)
=== prepare for test
=== pass
=== test for parameters
Address chainID is error!
Address chainID is error!
Address chainID is error!
Donee does not exist
Donee does not exist
=== pass
=== test for receipt of transfer
Please transfer token to me first
Accept only one donation at a time
Accept donations in genesis token only
=== pass
=== test for business logic
=== pass
=== Run  UnitTest case: Transfer(donee types.Address, value bn.Number)
=== prepare for test
=== pass
=== test for authorization
only contract owner just can do it
=== pass
=== test for parameters
Address chainID is error!
Address chainID is error!
Address chainID is error!
Donee does not exist
Donee does not exist
Donee does not exist
Donee does not exist
Parameter &quot;value&quot; must be greater than 0
Parameter &quot;value&quot; must be greater than 0
Donation is not enough
=== pass
=== test for business logic
=== pass
OK: 4 passed
--- PASS: Test (0.14s)
PASS
ok      contract/orgexample/code/mydonation/v1.0/mydonation    (cached)

Process finished with exit code 0
</code></pre>
</figure>
            </main>
            <div class="d-none d-lg-block side-nav py-2 py-md-5">
                <a href="https://github.com/bcbchain/docs/blob/master/docs/en-us/04-SmartContractDev\SmartContract(golang)\DevSmartContract\02-FirstSmartContract.md" class="contribution-link d-block">Improve this Doc</a>
                <div class="side-nav-text">In this article</div>
                <div id="navbar-sidenav">
                    <nav class='nav nav-pills flex-column'>
<a class='ml--2 d-none my-1 nav-link' href='#f08107d8'>First Smart Contract</a>
<nav class='nav nav-pills flex-column'>
<a class='ml-0 my-1 nav-link' href='#f1e90821'>1. Create a new contract</a>
<a class='ml-0 my-1 nav-link' href='#cb95d55e'>2. Donation Contract</a>
<nav class='nav nav-pills flex-column'>
<a class='ml-2 my-1 nav-link' href='#dbcf3a98'>2.1 AddDonee</a>
<a class='ml-2 my-1 nav-link' href='#dd257bd0'>2.2 DelDonee</a>
<a class='ml-2 my-1 nav-link' href='#a6913f3a'>2.3 Donate</a>
<a class='ml-2 my-1 nav-link' href='#d36ba1d7'>2.4 Transfer</a>
</nav>
<a class='ml-0 my-1 nav-link' href='#a48fa780'>3. Contract specification check</a>
<a class='ml-0 my-1 nav-link' href='#db6cebc6'>4. Contract code completion</a>
<a class='ml-0 my-1 nav-link' href='#dc6e7680'>5. Contract unit test</a>
</nav>
</nav>
                </div>
            </div>
        </div>
    </div>
    <div class="lightbulb" title="Turn On/Off" onclick="turnOff()">
        <i class="far fa-lightbulb"></i>
    </div>
    <footer>
    </footer>
    <script src="/lib/jquery/jquery.min.js"></script>
    <script src="/lib/popper.js/popper.min.js"></script>
    <script src="/lib/bootstrap/js/bootstrap.min.js"></script>
    <script src="/js/jquery.lazyload.min.js"></script>
    <script src="/js/utility.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/highlight.min.js"></script>
    <script src="/js/text-autospace.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130525731-2"></script>
    <script src="/js/site.min.js?v=20191106"></script>
    <script>
        //适用于FAQ的根据标题展开收缩
        if (false) {
            $("h2").click(function (e) {
                $(".div-collapse").not($(e.target).parents("h2").next()).hide("fast");
                $(e.target).parents("h2").next().toggle("fast");
            });
        }

        $("#sInput").bind({
            focus: function () {
                searchBar();
            },
            keyup: function (e) {
                clearTimeout();
                if (e.which == 13) {
                    searchBar();
                }
                setTimeout(searchBar, 300);
            },
            paste: function () {
                searchBar();
            }
        });

        $(".search-de").click(function () {
            $("#sInput").val("");
            $("#sResult").html("");
        })

        var url = window.location.origin;

        function searchBar() {
            k = $("#sInput").val();
            l = localStorage.getItem("lang") || navigator.language || "en-us";
            if (!k) $("#sResult").html("");
            $.ajax({
                type: "GET",
                url: url + "/?k=" + encodeURIComponent(k) + "&l=" + encodeURIComponent(l),
                contentType: "application/json;charset=utf-8",
                dataType: "json",
                success: function (data) {
                    var html = ""

                    if (data.length == 0) {
                        html += "<li><a><span> No results found. </span></a></li > ";
                    }
                    for (i in data) {
                        var _data = data[i];
                        html += "<li><a href=" + _data.Link + "><strong>" + _data.Title + "</strong><br />";
                        html += "<span>" + _data.Line + "</span></a></li>";
                    }
                    $("#sResult").html(html);
                },
                fail: function () {
                    alert("fail");
                }
            });
        }

    </script>
</body>
</html>
